---
title: "2025-09-18"
subtitle: "Enough statistics to be dangerous"
format: html
toc: true
---

# Welcome!


# Load the libraries


```{r}
library(easystats)
library(tidyverse)
library(ggpubr)
```

# Load the data

```{r}
penguins <- read.csv("https://vincentarelbundock.github.io/Rdatasets/csv/palmerpenguins/penguins.csv")

# head(d)  # see the first few rows, the "head" of the table
```



# Have fun!

# Regression


## y: numeric, x1: numeric, x2: nominal

Research question

>  Is weight a (linear) function of bill length and sex?


pseudo code:

`lm(y ~ x1 + x2, data = name_of_my_dataset)`


## Exercise

Write the lm code for the above research question.
Save the results of the lm in some object.

```{r}
modelx2 <- lm(body_mass_g ~ bill_length_mm + sex, data = penguins)

summary(modelx2)  # parameters(modelx2)
coef(modelx2)
modelx2
```

```{r}
parameters(modelx2) |> print_md()
```

# Case study on movie succes


## Load data

```{r}
movies <- read.csv("https://vincentarelbundock.github.io/Rdatasets/csv/ggplot2movies/movies.csv")
```


## Overview on data

Including missing data

```{r}
movies |> 
  describe_distribution() |> 
  print_md()
```


## Visualize DV

```{r}
ggdensity(movies, x = "rating")
```


## Prepare data

```{r}
movies_nona <-
  movies |> 
  filter(budget > 0)
```


## Model rating ~ budget


```{r}
m_movies_budget <-
  lm(rating~budget, data = movies)

parameters(m_movies_budget) |> 
  print_md()

r2(m_movies_budget) 
```


# Inferential stats

## Ex.: Model DV: weight, IV: sex

- run the model (using LM, that classical, frequentist)
- tell if the the IV is "significant"



### Cleanse penguins

```{r}
penguins_filtered <- 
penguins |>  # and then
  filter(sex == "male" | sex == "female")
```


```{r}
lm_peng_weight_sex_filtered <-
  lm(body_mass_g ~ sex, data = penguins_filtered)

parameters(lm_peng_weight_sex_filtered)
r2(lm_peng_weight_sex_filtered)
```

"We found a difference in weight between female and male penguins, 95%CI [526g, 841g], 
with male animals being heavier."

--> We reject the H0 (H0: no difference in MEANS! between the two groups).


## Bayesian flavor


```{r}
library(rstanarm) 
```


Nearly the same R code as above:

```{r}
lm_peng_weight_sex_filtered <-
  stan_glm(body_mass_g ~ sex, data = penguins_filtered)

parameters(lm_peng_weight_sex_filtered)
r2(lm_peng_weight_sex_filtered)
```



# Common research designs


```{mermaid}
flowchart LR
  g_control --> Y
  g_exp --> Y
```


